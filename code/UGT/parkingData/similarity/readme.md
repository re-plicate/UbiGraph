## 流程

### 1. 数据处理

​	（1）根据原始数据的点的geom属性，计算出该点的经纬度。
​	（2）将点按cluster进行分类，不同的cluster存储在不同的excel文件中。并且去除每个cluster中重复的数据。
​	（3）计算每个聚类的内部关系。计算逻辑是：两个点如果属于不同类别则权重为0；如果属于相同类型，则将两点距离的倒数作为关系值。
​	（4）计算不同聚类的跨图关系。计算逻辑是：如果聚类A的点a的类别或者osm_id属性值和聚类B的点b的值相等，则这两个点之间的权重置为1，否则为0。

### 2. 跨图相似度计算

​		在第一步中得到了每个聚类的内部节点关系，以及这一聚类和其他聚类的节点关系。把聚类A的内部关系稀疏矩阵、聚类B的内部关系稀疏矩阵和聚类A、B之间的关系作为输入就可以得到聚类A和B的跨图相似度。计算的公式就和CoSimHeat论文里的公式一样。![image-20231125170318293](C:\Users\10070\AppData\Roaming\Typora\typora-user-images\image-20231125170318293.png)

只不过CoSimHeat计算的是两个图中的单个节点对之间的关系。在这里需要的是两个聚类的整体相似度，所以就简单的把跨图相似度计算出来的相似度矩阵的和作为这两个聚类的整体相似度。然后存到CoSimHeat矩阵中对应位置上（比如i行j列，表示聚类i和聚类j的跨图相似度）。

### 3.归一化数据

​		将聚类i和其他所有的聚类的相似度值放在一个数组中对其进行归一化，得到最后的相似度结果值。

## 代码

### 		dataProcess.py

​		计算跨图相似度注释之前的都是对应的流程中的数据处理阶段；注释之后的是流程中的归一化数据阶段。不同时候就注释不同的代码块运行。

### 		CoSimHeatSimilarity.py

​		对应流程中的跨图相似度计算部分。最后面保存结果到文件的代码注释了，按需取消注释就行。

### 		Sparse_matrix.py

​		封装的计算跨图相似度计算函数